# Phase 1 AIS: single API (in-process ingest; no Redis/DB)
services:
  api:
    build:
      context: .
      dockerfile: Dockerfile.api
    environment:
      AISSTREAM_API_KEY: ${AISSTREAM_API_KEY:-}
      AISSTREAM_WS_URL: ${AISSTREAM_WS_URL:-wss://stream.aisstream.io/v0/stream}
      ZONE_NAME: ${ZONE_NAME:-Port of Halifax}
      ZONE_LAT_MIN: ${ZONE_LAT_MIN:-43}
      ZONE_LAT_MAX: ${ZONE_LAT_MAX:-47}
      ZONE_LON_MIN: ${ZONE_LON_MIN:--65}
      ZONE_LON_MAX: ${ZONE_LON_MAX:--61}
      API_PREFIX: /api/v1
      LOG_LEVEL: ${LOG_LEVEL:-INFO}
    ports:
      - "8000:8000"
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://localhost:8000/health/ready || exit 1"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 15s
